
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bien choisir les ressources &#8212; CIP201 - Maîtriser l’utilisation des serveurs de calcul</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Analyse des tâches" href="2-analyse-taches.html" />
    <link rel="prev" title="À propos" href="0-a_propos.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="fr">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CIP201 - Maîtriser l’utilisation des serveurs de calcul</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Rechercher dans ce livre ..." aria-label="Rechercher dans ce livre ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0-a_propos.html">
   À propos
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Bien choisir les ressources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2-analyse-taches.html">
   Analyse des tâches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-lots-taches.html">
   Lots de tâches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4-stockage.html">
   Les espaces de stockage
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Basculer la navigation" aria-controls="site-navigation"
                title="Basculer la navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Téléchargez cette page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/1-ressources.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Télécharger le fichier source" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimer au format PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/calculquebec/utilisation-serveurs-calcul"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Dépôt source"><i
                    class="fab fa-github"></i>dépôt</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Mode plein écran"
        title="Mode plein écran"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenu
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rappel-le-calcul-haute-performance">
   Rappel - le calcul haute performance
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectif-construction-d-un-script-de-tache-slurm">
     Objectif - construction d’un script de tâche Slurm
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-des-calculs-a-petite-echelle">
   Analyse des calculs à petite échelle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sous-windows">
     Sous Windows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sous-mac-os">
     Sous Mac OS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sous-linux">
     Sous Linux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sur-la-grappe-de-calcul-directement">
     Sur la grappe de calcul directement
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ressources-utilisees-d-une-tache-terminee">
       Ressources utilisées d’une tâche terminée
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ressources-utilisees-par-une-tache-cpu-en-cours">
       Ressources utilisées par une tâche CPU en cours
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ressources-utilisees-par-une-tache-gpu-en-cours">
       Ressources utilisées par une tâche GPU en cours
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparer-la-vitesse-cpu-vs-gpu">
       Comparer la vitesse CPU vs GPU
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercice-calcul-d-acceleration-et-d-efficacite">
       Exercice - Calcul d’accélération et d’efficacité
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extrapoler-les-ressources-necessaires">
   Extrapoler les ressources nécessaires
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#efficacite-cible-du-calcul-parallele">
     Efficacité cible du calcul parallèle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taille-des-donnees-et-nombre-de-fichiers-a-traiter">
     Taille des données et nombre de fichiers à traiter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stockage-en-memoire-selon-les-types-de-base">
       Stockage en mémoire selon les types de base
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#la-complexite-des-algorithmes">
       La complexité des algorithmes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercice-complexite-de-l-algorithme">
       Exercice - Complexité de l’algorithme
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principales-differences-entre-les-grappes-de-calcul">
   Principales différences entre les grappes de calcul
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#points-a-retenir">
   Points à retenir
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Bien choisir les ressources</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contenu </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rappel-le-calcul-haute-performance">
   Rappel - le calcul haute performance
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectif-construction-d-un-script-de-tache-slurm">
     Objectif - construction d’un script de tâche Slurm
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-des-calculs-a-petite-echelle">
   Analyse des calculs à petite échelle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sous-windows">
     Sous Windows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sous-mac-os">
     Sous Mac OS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sous-linux">
     Sous Linux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sur-la-grappe-de-calcul-directement">
     Sur la grappe de calcul directement
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ressources-utilisees-d-une-tache-terminee">
       Ressources utilisées d’une tâche terminée
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ressources-utilisees-par-une-tache-cpu-en-cours">
       Ressources utilisées par une tâche CPU en cours
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ressources-utilisees-par-une-tache-gpu-en-cours">
       Ressources utilisées par une tâche GPU en cours
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparer-la-vitesse-cpu-vs-gpu">
       Comparer la vitesse CPU vs GPU
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercice-calcul-d-acceleration-et-d-efficacite">
       Exercice - Calcul d’accélération et d’efficacité
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extrapoler-les-ressources-necessaires">
   Extrapoler les ressources nécessaires
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#efficacite-cible-du-calcul-parallele">
     Efficacité cible du calcul parallèle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taille-des-donnees-et-nombre-de-fichiers-a-traiter">
     Taille des données et nombre de fichiers à traiter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stockage-en-memoire-selon-les-types-de-base">
       Stockage en mémoire selon les types de base
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#la-complexite-des-algorithmes">
       La complexité des algorithmes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercice-complexite-de-l-algorithme">
       Exercice - Complexité de l’algorithme
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principales-differences-entre-les-grappes-de-calcul">
   Principales différences entre les grappes de calcul
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#points-a-retenir">
   Points à retenir
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="bien-choisir-les-ressources">
<h1>Bien choisir les ressources<a class="headerlink" href="#bien-choisir-les-ressources" title="Lien permanent vers ce titre">¶</a></h1>
<p>Il y a plusieurs ressources informatiques qui vous sont disponibles à
l’Alliance de recherche numérique du Canada :</p>
<ul class="simple">
<li><p>Calcul haute performance</p>
<ul>
<li><p>Béluga, Cedar, Graham, Narval, Niagara</p></li>
</ul>
</li>
<li><p>Stockage</p>
<ul>
<li><p>Temporaire, projet, <em>nearline</em>, dépôt de données de recherche</p></li>
</ul>
</li>
<li><p>Infonuagique</p>
<ul>
<li><p>Arbutus, Béluga, Cedar, Graham</p></li>
</ul>
</li>
</ul>
<p>Le principal but de ce chapitre est de vous permettre d’analyser
vos besoins en <strong>ressources de calcul haute performance</strong>, et ce,
dans le but de choisir les ressources nécessaires pour votre projet.</p>
<div class="section" id="rappel-le-calcul-haute-performance">
<h2>Rappel - le calcul haute performance<a class="headerlink" href="#rappel-le-calcul-haute-performance" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Lorsqu’il est question de lancer une <strong>grande quantité de calculs</strong>
(séquentiels ou parallèles) ou de <strong>traitements de données</strong>,
l’utilisation d’une grappe de calcul haute performance devient nécessaire.</p></li>
<li><p>Puisque les <strong>ressources sont partagées</strong> et en grande demande,
chaque tâche doit être soumise à un ordonnanceur de tâches.</p></li>
<li><p>Il devient donc nécessaire <strong>d’estimer à l’avance les ressources</strong>
qui seront réservées lors de l’exécution d’un calcul.</p></li>
</ul>
<p>Dans cette section, on cherche à évaluer le comportement d’une tâche de calcul
afin d’estimer et d’optimiser les ressources à réserver sur la grappe de calcul.</p>
<div class="section" id="objectif-construction-d-un-script-de-tache-slurm">
<h3>Objectif - construction d’un script de tâche Slurm<a class="headerlink" href="#objectif-construction-d-un-script-de-tache-slurm" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un script de tâche pour <a class="reference external" href="https://slurm.schedmd.com/documentation.html">l’ordonnanceur Slurm</a> est typiquement un script Bash dans lequel on retrouve :</p>
<ul class="simple">
<li><p>Le <a class="reference external" href="https://fr.wikipedia.org/wiki/Shebang">shebang</a> en toute première ligne. Par exemple : <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p></li>
<li><p>Les options <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code> en entête pour les besoins de la tâche. Les options en entête seront lues par la commande de soumission de tâche <a class="reference external" href="https://slurm.schedmd.com/sbatch.html"><code class="docutils literal notranslate"><span class="pre">sbatch</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Utiliser_des_modules">Chargement des modules</a> requis</p></li>
<li><p>Les commandes Bash qui seront exécutées automatiquement sur des processeurs réservés pour la tâche</p></li>
</ul>
<p>Par exemple : <a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/mpi_allo.sh"><code class="docutils literal notranslate"><span class="pre">scripts/mpi_allo.sh</span></code></a></p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>cat scripts/mpi_allo.sh
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --ntasks=10</span>
<span class="c1">#SBATCH --mem-per-cpu=1000M</span>
<span class="c1">#SBATCH --time=0-00:10</span>

<span class="n">mpirun</span> <span class="n">printenv</span> <span class="n">HOSTNAME</span> <span class="n">OMPI_COMM_WORLD_RANK</span> <span class="n">OMPI_COMM_WORLD_SIZE</span>
</pre></div>
</div>
<p>Notre documentation à cet effet débute à la page : <a class="reference external" href="https://docs.computecanada.ca/wiki/Running_jobs/fr">Exécuter des tâches</a></p>
</div>
</div>
<div class="section" id="analyse-des-calculs-a-petite-echelle">
<h2>Analyse des calculs à petite échelle<a class="headerlink" href="#analyse-des-calculs-a-petite-echelle" title="Lien permanent vers ce titre">¶</a></h2>
<p>Lorsqu’une tâche de calcul est en cours d’exécution, vous pouvez surveiller différentes métriques :</p>
<ul class="simple">
<li><p>Utilisation CPU (et GPU, s’il y a lieu)</p></li>
<li><p>Mémoire résidente (réellement utilisée)</p></li>
<li><p>Mémoire virtuelle (allouée)</p></li>
<li><p>Les accès au stockage</p></li>
</ul>
<div class="section" id="sous-windows">
<h3>Sous Windows<a class="headerlink" href="#sous-windows" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://fr.wikipedia.org/wiki/Gestionnaire_des_t%C3%A2ches_Windows">Gestionnaire des tâches Windows</a></p></li>
<li><p>Pour le faire afficher :</p>
<ul>
<li><p>Raccourcis clavier Ctrl+Alt+Suppr ou cliquer sur la barre des tâches avec le bouton droit</p></li>
<li><p>Cliquer sur l’option <em>Gestionnaire des tâches</em></p></li>
</ul>
</li>
</ul>
<p><img alt="Aperçu du gestionnaire des tâches Windows" src="_images/win-task-manager.png" /></p>
</div>
<div class="section" id="sous-mac-os">
<h3>Sous Mac OS<a class="headerlink" href="#sous-mac-os" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://support.apple.com/fr-ca/guide/activity-monitor/actmntr1001/mac">Moniteur d’activité</a></p></li>
<li><p>Pour le faire afficher :</p>
<ul>
<li><p>Démarrer l’application à partir des <em>Applications et Utilitaires</em> de Mac OS</p></li>
<li><p>Sinon, utiliser le raccourcis clavier Commande+Espace et taper les premières lettres de « Moniteur d’activité » pour pouvoir sélectionner cette application</p></li>
</ul>
</li>
</ul>
<p><img alt="Aperçu du moniteur d'activité Mac OS" src="https://help.apple.com/assets/5FDCF1894EB74318147EC0CF/5FDCF18A4EB74318147EC0D6/fr_CA/ad6337d66061aa27122e75521960fc5a.png" /></p>
</div>
<div class="section" id="sous-linux">
<h3>Sous Linux<a class="headerlink" href="#sous-linux" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans un terminal Unix, on peut utiliser :</p>
<ul class="simple">
<li><p>La <a class="reference external" href="https://man7.org/linux/man-pages/man1/top.1.html">commande <code class="docutils literal notranslate"><span class="pre">top</span></code></a> (<code class="docutils literal notranslate"><span class="pre">q</span></code> pour quitter)</p></li>
</ul>
<p><img alt="Capture de top" src="_images/linux-top.png" /></p>
<ul class="simple">
<li><p>La <a class="reference external" href="https://man7.org/linux/man-pages/man1/htop.1.html">commande <code class="docutils literal notranslate"><span class="pre">htop</span></code></a> (<code class="docutils literal notranslate"><span class="pre">q</span></code> pour quitter)</p></li>
</ul>
<p><img alt="Capture de htop" src="_images/linux-htop.png" /></p>
</div>
<div class="section" id="sur-la-grappe-de-calcul-directement">
<h3>Sur la grappe de calcul directement<a class="headerlink" href="#sur-la-grappe-de-calcul-directement" title="Lien permanent vers ce titre">¶</a></h3>
<p>Avec votre accès par défaut, vous avez un compte de calcul <code class="docutils literal notranslate"><span class="pre">def-*</span></code> de base
vous permettant de lancer des tâches de test.</p>
<div class="section" id="ressources-utilisees-d-une-tache-terminee">
<h4>Ressources utilisées d’une tâche terminée<a class="headerlink" href="#ressources-utilisees-d-une-tache-terminee" title="Lien permanent vers ce titre">¶</a></h4>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>ssh login1
...
</pre></div>
</div>
<p><strong>Note</strong> : pour accéder aux grappes de calcul en production,
il vaut mieux utiliser <a class="reference external" href="https://docs.computecanada.ca/wiki/Using_SSH_keys_in_Linux/fr">une paire de clés SSH</a>.</p>
<p>Pour soumettre un script, on fait :</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sbatch scripts/blastn-gen-seq.sh
</pre></div>
</div>
<p>Pour voir l’état de la tâche, on ferait :</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>squeue -u <span class="nv">$USER</span>  <span class="c1"># ou &#39;sq&#39;</span>
</pre></div>
</div>
<p>Avec la commande <a class="reference external" href="https://slurm.schedmd.com/sacct.html"><code class="docutils literal notranslate"><span class="pre">sacct</span></code></a>, on peut obtenir un tableau de nos tâches exécutées depuis minuit.</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sacct
</pre></div>
</div>
<p>Avec la commande <a class="reference external" href="https://docs.computecanada.ca/wiki/Running_jobs/fr#T.C3.A2ches_termin.C3.A9es"><code class="docutils literal notranslate"><span class="pre">seff</span></code></a>,
on peut obtenir un court rapport d’exécution de tâche.
Ce rapport inclut une mesure du temps écoulé, une mesure du temps CPU
et une mesure de consommation maximale de la mémoire-vive.
Des valeurs d’efficacité en pourcentages sont données pour les cycles CPU
et la mémoire-vives en fonction des quantités réservées.</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>seff &lt;No_tâche&gt;
</pre></div>
</div>
</div>
<div class="section" id="ressources-utilisees-par-une-tache-cpu-en-cours">
<h4>Ressources utilisées par une tâche CPU en cours<a class="headerlink" href="#ressources-utilisees-par-une-tache-cpu-en-cours" title="Lien permanent vers ce titre">¶</a></h4>
<p>Étant donné un certain calcul matriciel dans le script Python
<a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/crunch.py"><code class="docutils literal notranslate"><span class="pre">scripts/crunch.py</span></code></a> :</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>less scripts/crunch.py   <span class="c1"># q pour quitter</span>
</pre></div>
</div>
<p>Lors d’une tâche interactive, on peut utiliser <code class="docutils literal notranslate"><span class="pre">top</span></code> et <code class="docutils literal notranslate"><span class="pre">htop</span></code> pour surveiller les ressources utilisées :</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tâche interactive et installation de modules Python</span>
salloc --gres<span class="o">=</span>gpu:1 --ntasks-per-node<span class="o">=</span><span class="m">4</span> --mem<span class="o">=</span>8000M --time<span class="o">=</span><span class="m">0</span>:9:0
less scripts/installer/cupy_tmp.sh  <span class="c1"># q pour quitter</span>
bash scripts/installer/cupy_tmp.sh
</pre></div>
</div>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exécution avec un processeur</span>
less scripts/crunch_1cpu.sh  <span class="c1"># q pour quitter</span>
bash scripts/crunch_1cpu.sh  <span class="c1"># q pour quitter</span>

<span class="c1"># Exécution avec 4 processeurs</span>
less scripts/crunch_4cpu.sh  <span class="c1"># q pour quitter</span>
bash scripts/crunch_4cpu.sh  <span class="c1"># q pour quitter</span>

<span class="c1"># Comparer les résultats</span>
grep sec *.log

<span class="nb">exit</span>  <span class="c1"># Pour revenir à login1</span>
</pre></div>
</div>
</div>
<div class="section" id="ressources-utilisees-par-une-tache-gpu-en-cours">
<h4>Ressources utilisées par une tâche GPU en cours<a class="headerlink" href="#ressources-utilisees-par-une-tache-gpu-en-cours" title="Lien permanent vers ce titre">¶</a></h4>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tâche interactive et installation de modules Python</span>
salloc --gres<span class="o">=</span>gpu:1 --ntasks-per-node<span class="o">=</span><span class="m">4</span> --mem<span class="o">=</span>8000M --time<span class="o">=</span><span class="m">0</span>:9:0
bash scripts/installer/cupy_tmp.sh
</pre></div>
</div>
<ul class="simple">
<li><p>Pour Windows et Mac OS, il existe des outils propriétaires permettant de visualiser en temps réel l’utilisation du GPU. Veuillez vous référer au site Web du manufacturier de votre GPU pour les détails</p></li>
<li><p>Sous Linux, il y a d’abord la <a class="reference external" href="https://developer.nvidia.com/nvidia-system-management-interface">commande <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code></a></p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>nvidia-smi
</pre></div>
</div>
<p><img alt="Capture nvidia-smi" src="_images/nvidia-smi.png" /></p>
<ul class="simple">
<li><p>Il existe aussi un projet <a class="reference external" href="https://github.com/Syllo/nvtop"><code class="docutils literal notranslate"><span class="pre">nvtop</span></code></a> permettant de visualiser l’utilisation d’un ou plusieurs GPUs dans un terminal</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exécution avec 1 GPU</span>
less scripts/crunch_1gpu.sh  <span class="c1"># q pour quitter</span>
bash scripts/crunch_1gpu.sh  <span class="c1"># q pour quitter</span>

<span class="c1"># Regarder le résultat</span>
less tg.log    <span class="c1"># q pour quitter</span>

<span class="nb">exit</span>  <span class="c1"># Pour revenir à login1</span>
</pre></div>
</div>
<p><img alt="Capture nvtop" src="https://raw.githubusercontent.com/Syllo/nvtop/master/screenshot/NVTOP_ex1.png" /></p>
</div>
<div class="section" id="comparer-la-vitesse-cpu-vs-gpu">
<h4>Comparer la vitesse CPU vs GPU<a class="headerlink" href="#comparer-la-vitesse-cpu-vs-gpu" title="Lien permanent vers ce titre">¶</a></h4>
<p>Avant d’utiliser massivement les GPUs d’une grappe de calcul, il faut tout d’abord que l’application ou l’algorithme puisse démontrer une « bonne performance » en utilisant plusieurs processeurs en parallèle.</p>
<p>Quelques définitions :</p>
<ul class="simple">
<li><p><strong>Temps écoulé</strong> = temps d’exécution total que l’on perçoit et non le temps CPU</p></li>
<li><p><strong>Accélération</strong> = (temps avec un processeur) / (temps avec parallélisme)</p></li>
<li><p><strong>Efficacité</strong> = (Accélération) / (nombre de processeurs)</p></li>
</ul>
<p>Le coût d’un noeud GPU étant de quatre à cinq fois supérieur à celui d’un noeud régulier, l’utilisation d’un seul GPU doit permettre une accélération d’au moins quatre fois (4x) la vitesse de huit (8) à douze (12) processeurs.</p>
<ul class="simple">
<li><p><strong>Accélération</strong> = (temps avec 8 à 12 processeurs) / (temps avec un accélérateur)</p></li>
</ul>
</div>
<div class="section" id="exercice-calcul-d-acceleration-et-d-efficacite">
<h4>Exercice - Calcul d’accélération et d’efficacité<a class="headerlink" href="#exercice-calcul-d-acceleration-et-d-efficacite" title="Lien permanent vers ce titre">¶</a></h4>
<p>En supposant les résultats suivants pour un programme parallèle lancé sur <span class="math notranslate nohighlight">\(n\)</span> processeurs :</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>grep sec t*.log
</pre></div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(n\)</span> proc.</p></th>
<th class="text-align:center head"><p>temp (s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>9.876</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>5.220</p></td>
</tr>
</tbody>
</table>
<p>Étant donné le script <a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/calc-acc-eff.sh"><code class="docutils literal notranslate"><span class="pre">scripts/calc-acc-eff.sh</span></code></a> :</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>bash scripts/calc-acc-eff.sh <span class="m">1</span>:9.876 <span class="m">4</span>:5.220
bash scripts/calc-acc-eff.sh <span class="m">1</span>:9.876 <span class="m">8</span>:0.035
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extrapoler-les-ressources-necessaires">
<h2>Extrapoler les ressources nécessaires<a class="headerlink" href="#extrapoler-les-ressources-necessaires" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="efficacite-cible-du-calcul-parallele">
<h3>Efficacité cible du calcul parallèle<a class="headerlink" href="#efficacite-cible-du-calcul-parallele" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><p>Une efficacité de 80%, voire 90%, devrait être un seuil minimal pour les tâches parallèles. Or, il existe un <strong>nombre maximal de processeurs</strong> à utiliser pour respecter ce seuil :</p>
<ul>
<li><p>Voir la figure dans la page <a class="reference external" href="https://fr.wikipedia.org/wiki/Loi_d%27Amdahl">loi d’Amdahl</a></p></li>
<li><p>Matériel en extra <a class="reference internal" href="extra/loi-Amdahl.html"><span class="doc std std-doc">ici</span></a></p></li>
</ul>
</li>
<li><p>On vise aussi une consommation en mémoire-vive de l’ordre de 80% de ce qui est demandé à l’ordonnanceur Slurm</p></li>
</ul>
<p>Rappel - vous pouvez obtenir ces pourcentages via les commandes <code class="docutils literal notranslate"><span class="pre">sacct</span> <span class="pre">-X</span></code> (surtout pour obtenir les numéros de tâches) et <code class="docutils literal notranslate"><span class="pre">seff</span></code>. Les valeurs à considérer sont :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CPU</span> <span class="pre">Utilized</span></code> et <code class="docutils literal notranslate"><span class="pre">CPU</span> <span class="pre">Efficiency</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Utilized</span></code> et <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Efficiency</span></code></p></li>
</ul>
</div>
<div class="section" id="taille-des-donnees-et-nombre-de-fichiers-a-traiter">
<h3>Taille des données et nombre de fichiers à traiter<a class="headerlink" href="#taille-des-donnees-et-nombre-de-fichiers-a-traiter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour un calcul donné, il y a deux métriques de stockage à considérer :</p>
<ol class="simple">
<li><p>La <strong>quantité</strong> totale en octets (ou Go)</p></li>
<li><p>Le <strong>nombre</strong> total de fichiers</p></li>
</ol>
<p>Pour obtenir ces informations :</p>
<ul class="simple">
<li><p><strong>Sous Windows</strong> : dans l’explorateur Windows (raccourcis clavier : Windows + E)</p>
<ul>
<li><p>Sélectionner un dossier ou plusieurs fichiers</p></li>
<li><p>Bouton droit de la souris -&gt; <em>Propriétés</em></p></li>
</ul>
</li>
</ul>
<p><img alt="Windows data properties" src="_images/win-data-size.png" /></p>
<ul class="simple">
<li><p><strong>Sous Mac OS</strong> : dans <em>Finder</em></p>
<ul>
<li><p>Sélectionner un dossier ou plusieurs fichiers</p></li>
<li><p>Bouton droit de la souris -&gt; <em>Get Info</em></p></li>
<li><p>Autrement : avec l’affichage <em>Par liste</em></p>
<ul>
<li><p><a class="reference external" href="https://www.solutionenligne.org/comment-afficher-taille-dossiers-fichiers-dans-finder-mac-os/">Activer <em>Calculer toutes les tailles</em></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p><strong>Sous Linux</strong> :</p>
<ul>
<li><p>L’environnement graphique peut offrir le même genre d’outils, mais tout dépend de la distribution et du bureau.</p></li>
<li><p>La commande <code class="docutils literal notranslate"><span class="pre">du</span> <span class="pre">-bs</span> <span class="pre">DOSSIER</span></code> (<code class="docutils literal notranslate"><span class="pre">b</span></code> : taille apparente en octets, <code class="docutils literal notranslate"><span class="pre">s</span></code> : somme totale) calcule récursivement et affiche la taille totale en octets. La taille apparente est celle qui importe lors d’un transfert ou d’une sauvegarde de données.</p></li>
<li><p>La commande <code class="docutils literal notranslate"><span class="pre">find</span> <span class="pre">DOSSIER</span> <span class="pre">|</span> <span class="pre">wc</span> <span class="pre">-l</span></code> compte récursivement et affiche le nombre de fichiers et de sous-dossiers.</p></li>
</ul>
</li>
</ul>
<div class="section" id="stockage-en-memoire-selon-les-types-de-base">
<h4>Stockage en mémoire selon les types de base<a class="headerlink" href="#stockage-en-memoire-selon-les-types-de-base" title="Lien permanent vers ce titre">¶</a></h4>
<p>En ayant une idée de la taille des données à traiter,
il devient possible d’estimer l’espace que les données prendront en mémoire-vive.</p>
<ul class="simple">
<li><p>Dans un fichier texte, <strong>chaque caractère</strong> prend de un (1) à deux (2) octets, en moyenne.
Cependant, pour certaines langues, l’encodage
<a class="reference external" href="https://fr.wikipedia.org/wiki/UTF-8#Description">UTF-8</a>
peut se rendre jusqu’à quatre (4) octets par caractère.
Pour les langues latines et germaniques, on peut considérer <strong>deux (2) octets</strong> par caractère.
Par exemple, dans une session Python :</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>python
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">euro</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">euro</span><span class="p">)</span>
<span class="mi">49</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">euro</span> <span class="o">=</span> <span class="s2">&quot;Euro&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">euro</span><span class="p">)</span>
<span class="mi">53</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">euro</span> <span class="o">=</span> <span class="s2">&quot;€&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">euro</span><span class="p">)</span>
<span class="mi">76</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">euro</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># Donc &quot;€€&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">euro</span><span class="p">)</span>
<span class="mi">78</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">quit</span><span class="p">()</span>  <span class="c1"># ou Ctrl+D pour sortir</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Les <strong>nombres entiers</strong> prennent typiquement 2 octets (16 bits), 4 octets (32 bits) ou 8 octets (64 bits) chacun. Tout dépend de la <a class="reference external" href="https://en.wikipedia.org/wiki/C_data_types#Main_types">plage de valeurs souhaitée</a> :</p>
<ul>
<li><p>2 octets : ~65 milles valeurs de <span class="math notranslate nohighlight">\(0\)</span> à <span class="math notranslate nohighlight">\(65535\)</span>, ou de <span class="math notranslate nohighlight">\(-32767\)</span> à <span class="math notranslate nohighlight">\(32767\)</span></p></li>
<li><p>4 octets : ~4 milliards de valeurs de 0 à <span class="math notranslate nohighlight">\((2^{32}-1)\)</span> ou de <span class="math notranslate nohighlight">\(-(2^{31}-1)\)</span> à <span class="math notranslate nohighlight">\((2^{31}-1)\)</span></p></li>
<li><p>8 octets : ~18 trillions de valeurs de 0 à <span class="math notranslate nohighlight">\((2^{64}-1)\)</span> ou de <span class="math notranslate nohighlight">\(-(2^{63}-1)\)</span> à <span class="math notranslate nohighlight">\((2^{63}-1)\)</span></p></li>
</ul>
</li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>module load python scipy-stack
python
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cube</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
<span class="mi">8000136</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cube</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
<span class="mi">4000136</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="n">iinfo</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">32768</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">32767</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int16</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Les <strong>nombres à virgule flottante</strong> prennent typiquement 4 octets (32 bits) ou 8 octets (64 bits) chacun, mais on voit de plus en plus <a class="reference external" href="https://en.wikipedia.org/wiki/Bfloat16_floating-point_format">différents types de données à 2 octets (16 bits)</a> dans des applications d’apprentissage-machine. Il se peut néanmoins que les données soient initialement en simple ou double précision:</p>
<ul>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Single-precision_floating-point_format">simple précision</a> : 4 octets, une résolution de 23 bits (~7 décimales), une échelle de 8 bits (<span class="math notranslate nohighlight">\({10}^{-38}\)</span> à <span class="math notranslate nohighlight">\({10}^{38}\)</span>)</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">double précision</a> : 8 octets, une résolution de 52 bits (~16 décimales), une échelle de 11 bits (<span class="math notranslate nohighlight">\({10}^{-308}\)</span> à <span class="math notranslate nohighlight">\({10}^{308}\)</span>)</p></li>
</ul>
</li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cube</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="mf">3.1415927</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="mf">3.1415927</span> <span class="mf">3.141592653589793</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Certains langages utilisent systématiquement <strong>8 octets</strong> (64 bits) par nombre.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Quadruple-precision_floating-point_format">Certains compilateurs et certaines bibliothèques</a> peuvent calculer des valeurs représentées avec 128 bits <a class="reference external" href="https://gmplib.org/">ou plus</a>.</p></li>
<li><p>Pour les nombres complexes, on multiplie l’espace mémoire par deux (2).</p></li>
</ul>
<p>Exemple de calcul de l’espace-mémoire :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">nb_matrices</span> <span class="o">=</span> <span class="mi">3</span>        <span class="c1"># Trois matrices C = prod_mat(A, B)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">taille</span> <span class="o">=</span> <span class="mi">25000</span>         <span class="c1"># Matrices carrées</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">octets_par_nombre</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Double précision</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">memoire</span> <span class="o">=</span> <span class="n">nb_matrices</span> <span class="o">*</span> <span class="n">taille</span><span class="o">*</span><span class="n">taille</span> <span class="o">*</span> <span class="n">octets_par_nombre</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">memoire</span> <span class="o">/</span> <span class="mi">1000</span><span class="o">**</span><span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">quit</span><span class="p">()</span>  <span class="c1"># ou Ctrl+D pour sortir</span>
</pre></div>
</div>
</div>
<div class="section" id="la-complexite-des-algorithmes">
<h4>La complexité des algorithmes<a class="headerlink" href="#la-complexite-des-algorithmes" title="Lien permanent vers ce titre">¶</a></h4>
<p>La question qui se pose : en augmentant la ou les dimensions du problème, quelles devraient être la durée du calcul et la consommation en mémoire-vive?
Une <a class="reference external" href="https://fr.wikipedia.org/wiki/Analyse_de_la_complexit%C3%A9_des_algorithmes">analyse de la complexité de l’algorithme principal</a>
permettrait de connaître l’ordre <span class="math notranslate nohighlight">\(O\)</span> du calcul en fonction de la taille <span class="math notranslate nohighlight">\(n\)</span> des données :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(O(n)\)</span>: proportionnel à <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(O(n*m)\)</span>: représente un calcul à deux (2) dimensions indépendantes</p></li>
<li><p><span class="math notranslate nohighlight">\(O(n^3)\)</span>: calcul d’ordre cubique</p></li>
<li><p><span class="math notranslate nohighlight">\(O(n*m*k^2)\)</span>: par exemple, un filtre de taille <span class="math notranslate nohighlight">\(k*k\)</span> sur une image <span class="math notranslate nohighlight">\(n*m\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(O(n*log(n))\)</span>: typique de certains
<a class="reference external" href="https://fr.wikipedia.org/wiki/Algorithme_de_tri#Comparaison_des_algorithmes">algorithmes de tri</a>
où il y a <span class="math notranslate nohighlight">\(n\)</span> éléments à trier en <span class="math notranslate nohighlight">\(log_2(n)\)</span> étapes.</p></li>
</ul>
<p>Une analyse détaillée du code (s’il est disponible) n’est pas nécessaire pour déterminer le type de calcul qui est fait.</p>
<ul class="simple">
<li><p>Vous pouvez vous inspirer des données en entrées pour deviner l’ordre du calcul principal.</p></li>
<li><p>Vous pouvez mesurer le temps d’exécution en fonction de la taille du problème. En extrapolant les résultats, il serait possible de prévoir le comportement du programme sur une grappe de calcul.</p></li>
</ul>
</div>
<div class="section" id="exercice-complexite-de-l-algorithme">
<h4>Exercice - Complexité de l’algorithme<a class="headerlink" href="#exercice-complexite-de-l-algorithme" title="Lien permanent vers ce titre">¶</a></h4>
<p>Dans cet exercice, il est question d’inverser une matrice de valeurs aléatoires de taille <span class="math notranslate nohighlight">\(n*n\)</span> :</p>
<ul class="simple">
<li><p>Soumettre le script <a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/inv-mat.sh"><code class="docutils literal notranslate"><span class="pre">scripts/inv-mat.sh</span></code></a> avec la commande <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> :</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sbatch scripts/inv-mat.sh
</pre></div>
</div>
<ul class="simple">
<li><p>Explorer les scripts Python
<a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/inv-mat.py"><code class="docutils literal notranslate"><span class="pre">scripts/inv-mat.py</span></code></a> et
<a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/inv-mat.sh"><code class="docutils literal notranslate"><span class="pre">scripts/inv-mat.sh</span></code></a> :</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>cat scripts/inv-mat.py
cat scripts/inv-mat.sh
</pre></div>
</div>
<ul class="simple">
<li><p>Suivre l’évolution du calcul avec <code class="docutils literal notranslate"><span class="pre">squeue</span> <span class="pre">-u</span> <span class="pre">$USER</span></code>, environ aux 30 secondes</p></li>
<li><p>Le résultat sera sauvegardé dans le fichier <code class="docutils literal notranslate"><span class="pre">temps_inv.csv</span></code></p></li>
<li><p>Analyse avec Python, Pandas et Numpy dans le script <a class="reference external" href="https://github.com/calculquebec/cip201-serveurs-calcul/blob/main/scripts/inv-mat-pred.py"><code class="docutils literal notranslate"><span class="pre">scripts/inv-mat-pred.py</span></code></a> :</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>module load gcc python scipy-stack

cat scripts/inv-mat-pred.py
python scripts/inv-mat-pred.py temps_inv.csv
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="principales-differences-entre-les-grappes-de-calcul">
<h2>Principales différences entre les grappes de calcul<a class="headerlink" href="#principales-differences-entre-les-grappes-de-calcul" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>À propos des grappes :</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/B%C3%A9luga">Béluga</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Cedar/fr">Cedar</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Graham/fr">Graham</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Narval">Narval</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Niagara/fr">Niagara</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p><strong>Mise en production</strong></p></td>
<td class="text-align:center"><p>Mars 2019</p></td>
<td class="text-align:center"><p>Juin 2017</p></td>
<td class="text-align:center"><p>Juin 2017</p></td>
<td class="text-align:center"><p>Octobre 2021</p></td>
<td class="text-align:center"><p>Avril 2018</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><strong>Ville</strong></p></td>
<td class="text-align:center"><p>Montréal</p></td>
<td class="text-align:center"><p>Burnaby</p></td>
<td class="text-align:center"><p>Waterloo</p></td>
<td class="text-align:center"><p>Montréal</p></td>
<td class="text-align:center"><p>Toronto</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><strong>Province</strong></p></td>
<td class="text-align:center"><p>Québec</p></td>
<td class="text-align:center"><p>C.-B.</p></td>
<td class="text-align:center"><p>Ontario</p></td>
<td class="text-align:center"><p>Québec</p></td>
<td class="text-align:center"><p>Ontario</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Nombre de processeurs (coeurs CPU) selon le cas :</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Processeur Intel/AMD</p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/B%C3%A9luga">Béluga</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Cedar/fr">Cedar</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Graham/fr">Graham</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Narval">Narval</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Niagara/fr">Niagara</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>Broadwell (avx2)</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>724 * 32</p></td>
<td class="text-align:center"><p>983 * 32</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Skylake (avx512)</p></td>
<td class="text-align:center"><p>802 * 40</p></td>
<td class="text-align:center"><p>640 * 48</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>1548 * 40</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>Cascade Lake (avx512)</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>768 * 48</p></td>
<td class="text-align:center"><p>72 * 44</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>468 * 40</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>EPYC Rome (avx2)</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>1142 * 64</p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Mémoire par proc.</p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/B%C3%A9luga">Béluga</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Cedar/fr">Cedar</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Graham/fr">Graham</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Narval">Narval</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Niagara/fr">Niagara</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>2400M</p></td>
<td class="text-align:center"><p>6400</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>4000M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>86016</p></td>
<td class="text-align:center"><p>28896</p></td>
<td class="text-align:center"><p>70976</p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>4400M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>3168</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>4800M</p></td>
<td class="text-align:center"><p>23560</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>80960</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>8000M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>3072</p></td>
<td class="text-align:center"><p>1792</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>16000M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>768</p></td>
<td class="text-align:center"><p>768</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>19200M</p></td>
<td class="text-align:center"><p>2120</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>32000M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>2112</p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>48000M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>768</p></td>
<td class="text-align:center"><p>192</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>96000M</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>128</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Using_GPUs_with_Slurm/fr">Nombre de GPUs</a> selon le cas :</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Accélérateurs</p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/B%C3%A9luga">Béluga</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Cedar/fr">Cedar</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Graham/fr">Graham</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.scinet.utoronto.ca/index.php/Mist">Mist (Power9)</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Narval">Narval</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>NVIDIA P100 12G</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>456</p></td>
<td class="text-align:center"><p>320</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>NVIDIA P100 16G</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>128</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>NVIDIA T4 16G</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>144</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>NVIDIA V100 16G</p></td>
<td class="text-align:center"><p>688</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>54</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>NVIDIA V100 32G</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>768</p></td>
<td class="text-align:center"><p>16</p></td>
<td class="text-align:center"><p>216</p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>NVIDIA A100 40G</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>632</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Réseau haute-performance et ordonnancement :</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/B%C3%A9luga">Béluga</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Cedar/fr">Cedar</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Graham/fr">Graham</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Narval">Narval</a></p></th>
<th class="text-align:center head"><p><a class="reference external" href="https://docs.computecanada.ca/wiki/Niagara/fr">Niagara</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>Connexion rapide</p></td>
<td class="text-align:center"><p>InfiniBand</p></td>
<td class="text-align:center"><p>OmniPath</p></td>
<td class="text-align:center"><p>InfiniBand</p></td>
<td class="text-align:center"><p>InfiniBand</p></td>
<td class="text-align:center"><p>InfiniBand</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Topologie</p></td>
<td class="text-align:center"><p>En arbre</p></td>
<td class="text-align:center"><p>En arbre</p></td>
<td class="text-align:center"><p>En arbre</p></td>
<td class="text-align:center"><p>En arbre</p></td>
<td class="text-align:center"><p>DragonFly+</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>Taille îlots (proc)</p></td>
<td class="text-align:center"><p>640 à 1200</p></td>
<td class="text-align:center"><p>1024 à 1536</p></td>
<td class="text-align:center"><p>1024</p></td>
<td class="text-align:center"><p>3072 à 3584</p></td>
<td class="text-align:center"><p>17280</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Facteur de blockage</p></td>
<td class="text-align:center"><p>max 5:1</p></td>
<td class="text-align:center"><p>max 2:1</p></td>
<td class="text-align:center"><p>max 8:1</p></td>
<td class="text-align:center"><p>max 4.7:1</p></td>
<td class="text-align:center"><p>max 2:1</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>Granularité des tâches</p></td>
<td class="text-align:center"><p>/proc /GPU</p></td>
<td class="text-align:center"><p>/proc /GPU</p></td>
<td class="text-align:center"><p>/proc /GPU</p></td>
<td class="text-align:center"><p>/proc /GPU</p></td>
<td class="text-align:center"><p>/noeud</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Durée maximale</p></td>
<td class="text-align:center"><p>7 jours</p></td>
<td class="text-align:center"><p>28 jours</p></td>
<td class="text-align:center"><p>28 jours</p></td>
<td class="text-align:center"><p>7 jours</p></td>
<td class="text-align:center"><p>1 jour</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Stockage : le tout sera décrit au dernier chapitre.</p></li>
</ul>
</div>
<div class="section" id="points-a-retenir">
<h2>Points à retenir<a class="headerlink" href="#points-a-retenir" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Prévoir les <strong>paramètres d’une tâche Slurm</strong></p>
<ul>
<li><p>Nombre de processeurs (CPU) et de noeuds de calcul</p></li>
<li><p>Nombre d’accélérateurs (GPU)</p></li>
<li><p>Quantité de mémoire-vive (RAM)</p></li>
<li><p>Temps du calcul (<code class="docutils literal notranslate"><span class="pre">JJ-H:M</span></code> ou <code class="docutils literal notranslate"><span class="pre">H:M:S</span></code>)</p></li>
</ul>
</li>
<li><p>Différents <strong>outils pour surveiller</strong> les ressources utilisées</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">time</span></code> et autres bibliothèques de mesure du temps écoulé</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">top</span></code>, <code class="docutils literal notranslate"><span class="pre">htop</span></code>, <code class="docutils literal notranslate"><span class="pre">nvtop</span></code>, <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sacct</span></code>, <code class="docutils literal notranslate"><span class="pre">seff</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">du</span> <span class="pre">-bs</span></code>, <code class="docutils literal notranslate"><span class="pre">find</span> <span class="pre">|</span> <span class="pre">wc</span> <span class="pre">-l</span></code> et autres outils du système d’exploitation</p></li>
</ul>
</li>
<li><p>On vise une <strong>efficacité de 80%</strong> pour les tâches parallèles CPU</p>
<ul>
<li><p>L’accélération avec un accélérateur (GPU) doit être significative (&gt;4x)</p></li>
</ul>
</li>
<li><p>Le choix de la grappe dépend des besoins de chaque type de calcul</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="0-a_propos.html" title="précédent page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">précédent</p>
            <p class="prev-next-title">À propos</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2-analyse-taches.html" title="suivant page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Analyse des tâches</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Par Équipe Calcul Québec<br/>
    
        &copy; droits d'auteur 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>